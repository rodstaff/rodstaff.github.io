<!DOCTYPE html>
	<html>
		<head>
		  <title>Blog1</title>
		  <link rel="stylesheet" type="text/css" href="./styles.css">
		  <link href="https://fonts.googleapis.com/css?family=Noticia+Text" rel="stylesheet">
		</head>
	    <body>
	      <h2>An Easier Approach to Deploy ReactJS and Redux to Heroku Using the Webpack bundle.js File in a Super Lightweight App<em>&nbsp;&nbsp;--by Rod Kay, 10/17/2016</em></h2>

	      <h3>1. &nbsp;&nbsp;Summary</h3>

	      <p>Existing free online sources (available at the time of this writing) regarding deployment of reactJS apps especially with the redux framework are not easy to follow moreso since authors have different styles and preferences.  &nbsp;&nbsp;This blog proposes a much simpler approach to Heroku depoyment by reducing and transforming the app into a much lighter version.&nbsp;</p>

	      <p>This blog assumes that the reader already has some background with reactJS, a bit of redux, Git source control and Heroku deployment.  This is not meant to be a tutorial but a proposal to simplify development.</p>

	      <h3>2. &nbsp;&nbsp;Development</h3>

	      <p>This blog was actually inspired by the difficulties I encountered in deploying an app I created in reactJS using react-router in a redux framework.  &nbsp;&nbsp;Coding <a href="https://github.com/rodstaff/redux-react-routes"><em>redux-react-routes</em></a> was an exciting but circuitous journey by itself; and if that were not enough, I found out later that there was no clear and definitive method available online to deploy it to Heroku! &nbsp;&nbsp;I finally realized, however, that no matter how complicated the code was, all of it (except for e.g. styling, images) would eventually bundled and coded in one consolidated javaScript file!</p>

	      <p>Below in Figs 2.1 to 2.4, I will briefly show how I created the bundle.js file by using the Webpack bundler tool.</p>
	      
	      <p><d>Fig. 2.1 &nbsp;&nbsp;<em>Redux-React-Routes</em> App Folder Structure.</d></p>

	      &nbsp;&nbsp;&nbsp;&nbsp;Those marked in * are folders. <br/>
	      &nbsp;&nbsp;&nbsp;&nbsp;Those marked in (red)^ are the only files that will be used in Heroku deployment.

 <pre>
	      routes* --|___ index.js             <-- entry point of the app
	                |___ app.js               <-- topmost react-route component
	                |___ container.js  
	                |___ home.js       
	                |___.                   
	                |___.             

	         dev* --|__js*____
  	                |         |_ actions*     <-- Redux/React section
	                |         |_ components*  <-- Redux/React section
	                |         |_ containers*  <-- Redux/React section
	                |         |_ reducers*    <-- Redux/React section
	                |
                        |__scss*__
                        |         |_style.scss  <-- styling (for future use)
                        |
                        |_ store.js             <-- Redux/React section

              public* --
                        |_ <em>index.html^</em>
                        |_ <em>style.css^</em>

         node_modules*--|_ .                    <-- module installs (included in .gitignore)
                        |_ .
                        |_ .
       
          
           
        <em>package.json^</em>
    webpack.config.js
 </pre>

        

        <p><d>Fig. 2.2 &nbsp;&nbsp;Redux-React-Routes <em>webpack.config.js</em> File.</d></p>

        &nbsp;&nbsp;&nbsp;&nbsp;A portion of the webpack.config.js file is shown below.
 <pre>
    module.exports = {
      entry: './routes', 
      output: {
        path: '../redux-react-heroku',   <-- When '@npm run wbp' is executed, the bundle.js file is moved into the adjacent folder
        filename: 'bundle.js'  
      },
      devServer: {
        inline: true,   
        publicPath: '/',    
        port: 8089
      },
 </pre>

        <p><d>Fig. 2.3 &nbsp;&nbsp;Redux-React-Routes <em>package.json</em> File.</d></p>
        &nbsp;&nbsp;&nbsp;&nbsp;The most important parts of the package.json file are shown below.
 <pre>
   "scripts": {
      "wbp": "webpack",
      "dev": "webpack-dev-server --progress --colors --hot --inline --content-base public/"
   },
   "dependencies": {
      "axios": "^0.14.0",
      "babel-core": "^6.10.4",
      "babel-loader": "^6.2.4",
      "babel-plugin-add-module-exports": "^0.2.1",
      "babel-plugin-react-html-attrs": "^2.0.0",
      "babel-plugin-react-transform": "^2.0.2",
      "babel-plugin-transform-class-properties": "^6.11.5",
      "babel-plugin-transform-decorators-legacy": "^1.3.4",
      "babel-plugin-transform-object-rest-spread": "^6.8.0",
      "babel-polyfill": "^6.9.1",
      "babel-preset-es2015": "^6.9.0",
      "babel-preset-react": "^6.11.1",
      "babel-preset-stage-0": "^6.5.0",
      "babel-register": "^6.9.0",
      "cross-env": "^1.0.8",
      "css-loader": "^0.23.1",
      "expect": "^1.20.1",
      "history": "^1.17.0",
      "node-libs-browser": "^1.0.0",
      "node-sass": "^3.8.0",
      "react": "^15.1.0",
      "react-addons-test-utils": "^15.1.0",
      "react-dom": "^15.1.0",
      "react-redux": "^4.4.5",
      "react-router": "^2.7.0",
      "react-router-redux": "^4.0.5",
      "react-transform-hmr": "^1.0.4",
      "redux": "^3.5.2",
      "redux-logger": "^2.6.1",
      "redux-promise": "^0.5.3",
      "redux-promise-middleware": "^4.0.0",
      "redux-thunk": "^2.1.0",
      "sass-loader": "^4.0.0",
      "style-loader": "^0.13.1",
      "webpack": "^1.13.1",
      "webpack-dev-middleware": "^1.6.1",
      "webpack-dev-server": "^1.14.1",
      "webpack-hot-middleware": "^2.11.0"
    }
 </pre>

        <p>The redux-react-routes app uses client side rendering but in development you can use the webpack-dev-server which you can set for auto-browser refresh when you change any file content.  &nbsp;&nbsp;To do this, inside your working directory simply type the command in your terminal as shown in Fig. 2.4.</p>

      <p><d>Fig. 2.4 &nbsp;&nbsp;Using the Webpack-Dev-Server.</d></p>
 <pre>
      $npm run dev      <-- "dev" is the script defined in package.json (see Fig. 2.3)

      localhost:8089    <-- type this in your browser ('8089' is the port no. in Fig. 2.2)
 </pre>

      <h3>3. &nbsp;&nbsp;Heroku Deployment</h3>

        <p>Once you have done sufficient debugging and testing and you're ready to proudly show the world what you have done, it's time to deploy to Heroku. &nbsp;&nbsp;For this you will need to create and copy the the bundle.js file with Webpack as shown in Fig. 3.1.</p>

 <p><d>Fig. 3.1 &nbsp;&nbsp;Bundle with Webpack and Deploy.</d></p>
 <pre>
      $npm run wbp                                  <-- "wbp" is the script defined in package.json (see Fig. 2.3)
                                                    <-- This generates the bundle.js file and moved for deployment (see Fig. 2.2)
      $cd ../redux-react-heroku                     <-- Change working directory to the adjacent directory/folder
      $git add bundle.js                            <-- Prepare commit to github (this assumes that all other files in the folder have been previously pushed.)
      $git commit -m "created bundle.js file"       <-- Staging the file 
      $git push origin master                       <-- Push to your Github repository
      $git push heroku master                       <-- Deploy to Heroku!
 </pre>

        <p>Fig. 3.2 shows <a href="https://github.com/rodstaff/redux-react-heroku"><em>redux-react-heroku</em></a> flat folder structure created specifically for Heroku deployment; and as you can see, it has only a total of 6 functional files--around 20 less files (inside the folders) than the development app! &nbsp;&nbsp;Compare with Fig. 2.1</p>

        <p><d>Fig. 3.2 &nbsp;&nbsp;Redux-React-Heroku App (Flat) Folder Structure.</d></p>

 <pre>
      server.js        <-- entry point of the app
      bundle.js          
      <em>index.html</em>
      <em>style.css</em>
      <em>package.json</em>     <-- The only file copied (in red) that will change in content!
      Procfile
      node_modules     <-- module installs (included in .gitignore)
 </pre>

        <p><d>Fig. 3.3 &nbsp;&nbsp;The server.js File.</d></p>

 <pre>
      var express = require('express');
      var app = express();
      var port = process.env.PORT || 8080

      app.use(express.static(__dirname + '/'));

      app.listen(port);
      console.log("server running on port " + port);
 </pre>

        <p><d>Fig. 3.4 &nbsp;&nbsp;The New package.json File.</d></p>

 <pre>
      "dependencies": {
        "express": "^4.14.0"
      },
      "engines": {
        "node": "4.4.3"
      }
 </pre>

        <p><d>Fig. 3.5 &nbsp;&nbsp;The Procfile File.</d></p>

 <pre>
      web: node server.js
 </pre>

        <p>Figs 3.1 to 3.5 show how super lightweight this app really is.  &nbsp;&nbsp;Note that now it uses server side rendering with only 6 (5 if you don't include the console.log command) lines of code! &nbsp;&nbsp;Because the result of all the long (but fun) sleepless nights of development are finally bundled up into one single bundle.js file, you will note in Fig. 3.4 how simple the package.json file becomes.  &nbsp;&nbsp;You just need to make sure of the express and node versions that you used.  &nbsp;&nbsp;Finally, the Procfile will instruct Heroku how to execute and run the app after deployment.</p>

      <h3>4. &nbsp;&nbsp;Combining The Two Apps Into One</h3>
        <p>In the examples here, I used two separate apps for development and production or deployment. &nbsp;&nbsp;Now, it is of course possible to combine these into just one app by, for example, the smart use of the .gitignore file and having two versions of the package.json file to make sure that the deployed version remain super lightweight. &nbsp;&nbsp;However, in my opinion, having two separate folders is the better option since you do not have to alter any files within the development folder for deployment as shown above making it quicker and snappier!</p>

      <h3>5. &nbsp;&nbsp;Conclusion</h3>
        <p>I have seen several online versions of deploying to Heroku and they differ widely depending on the coding style of the author and therefore are not very easy to follow especially if you are unfamiliar with their methods. &nbsp;&nbsp;Once you get used to any method, however, code and modules also get outdated fairly quickly so there is a good chance that your program might not even work! &nbsp;&nbsp;The proposal here is to shorten and simplify Heroku deployment by using the bundled file created by Webpack and to create a separate and simple lightweight app that will use this file simplifying the process of deployment further. &nbsp;&nbsp;I hope that this was helpful.</p>

        <p><em>Comments/Suggestions are welcome!</em> &nbsp;&nbsp;<a href="mailto:rodk1718@gmail.com">email</a>&nbsp;&nbsp;&nbsp;&nbsp;<em>About Me</em>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.rodkay.tech">Website</a></p>

	    </body>
	</html>